package ziggurat

import (
	"math"
	"math/rand/v2"
)

// TODO - Hex/uint64?
var optimizedNormalZigguratStripSplits [1024]float64 = [1024]float64{4.039359821024433, 3.853046592355272, 3.7392579854342864, 3.6561147680682247, 3.590130880054757, 3.535185453120877, 3.487964887242275, 3.446466766799144, 3.4093856985973376, 3.3758219659547737, 3.3451284063593154, 3.3168235023658705, 3.2905390009790394, 3.265986781553452, 3.2429370493870384, 3.221203497540751, 3.200632920092254, 3.1810977617867033, 3.1624906591736144, 3.1447203655087246, 3.1277086579020397, 3.111387955047532, 3.0956994577968495, 3.0805916803546225, 3.0660192773663844, 3.051942097972445, 3.038324415962974, 3.0251342980112477, 3.0123430812230994, 2.9999249380073807, 2.9878565112766053, 2.9761166067294025, 2.9646859317943925, 2.953546872972708, 2.9426833049775003, 2.932080426358378, 2.9217246173078757, 2.9116033161426147, 2.901704911583393, 2.892018648463088, 2.882534544897111, 2.8732433192793088, 2.8641363257332055, 2.8552054968667067, 2.846443292857767, 2.837842656046602, 2.829396970332856, 2.8211000247784694, 2.812945980902561, 2.80492934322655, 2.7970449326882973, 2.7892878625953577, 2.7816535168309016, 2.774137530062996, 2.7667357697395625, 2.759444319678527, 2.7522594650859906, 2.745177678855395, 2.7381956090180606, 2.7313100672305337, 2.7245180181973208, 2.7178165699389596, 2.711202964825415, 2.704674571303419, 2.698228876254135, 2.6918634779241604, 2.685576079378866, 2.679364482432284, 2.6732265820123766, 2.6671603609246195, 2.661163884980481, 2.6552352984605943, 2.649372819885321, 2.6435747380679655, 2.6378394084281873, 2.632165249545241, 2.6265507399324877, 2.6209944150163023, 2.615494864303964, 2.610050728726486, 2.6046606981435185, 2.599323508998577, 2.5940379421138084, 2.5888028206144265, 2.583617007973735, 2.5784794061703935, 2.573388953950272, 2.568344625185806, 2.563345427326353, 2.558390399933536, 2.5534786132960132, 2.5486091671185624, 2.5437811892807054, 2.538993834660499, 2.534246284019401, 2.529537742944438, 2.524867440844166, 2.5202346299951577, 2.5156385846359854, 2.5110786001058885, 2.5065539920254833, 2.502064095517075, 2.4976082644622895, 2.4931858707948917, 2.488796303826801, 2.484438969605441, 2.4801132903007, 2.475818703619847, 2.4715546622489124, 2.4673206333190802, 2.4631160978967714, 2.4589405504961497, 2.4547934986128843, 2.4506744622780547, 2.446582973631162, 2.4425185765112687, 2.4384808260653466, 2.4344692883729717, 2.4304835400865463, 2.426523168086281, 2.4225877691492204, 2.4186769496316196, 2.4147903251640335, 2.41092752035851, 2.4070881685273164, 2.403271911412646, 2.3994783989268043, 2.3957072889023827, 2.391958246851962, 2.388230945736908, 2.384525065744858, 2.3808402940754934, 2.377176324734242, 2.3735328583335518, 2.3699096019014023, 2.36630626869675, 2.3627225780315926, 2.359158255099376, 2.3556130308094767, 2.3520866416274906, 2.3485788294211005, 2.3450893413112732, 2.3416179295285806, 2.3381643512744184, 2.3347283685869367, 2.3313097482114835, 2.327908261475377, 2.3245236841668446, 2.3211557964179477, 2.3178043825913472, 2.3144692311707558, 2.311150134654927, 2.307846889455057, 2.30455929579545, 2.3012871576173466, 2.298030282485766, 2.294788481499276, 2.2915615692025635, 2.288349363501705, 2.2851516855820426, 2.281968359828564, 2.2787992137486945, 2.275644077897423, 2.2725027858046576, 2.26937517390476, 2.2662610814681496, 2.2631603505349283, 2.260072825850442, 2.2569983548027177, 2.2539367873617, 2.250887976020243, 2.247851775736778, 2.2448280438796138, 2.2418166401728046, 2.2388174266435383, 2.2358302675709933, 2.2328550294366134, 2.2298915808757505, 2.226939792630638, 2.223999537504643, 2.2210706903177626, 2.2181531278633155, 2.2152467288657993, 2.21235137393987, 2.2094669455504072, 2.2065933279736396, 2.2037304072592807, 2.200878071193663, 2.1980362092638197, 2.1952047126225027, 2.1923834740540897, 2.1895723879413724, 2.1867713502331805, 2.183980258412827, 2.181199011467351, 2.1784275098575216, 2.1756656554886, 2.172913351681813, 2.1701705031465406, 2.167437015953179, 2.1647127975066662, 2.1619977565206545, 2.159291802992299, 2.1565948481776624, 2.1539068045676957, 2.1512275858648033, 2.1485571069599505, 2.1458952839103222, 2.1432420339174953, 2.140597275306128, 2.137960927503142, 2.1353329110173798, 2.1327131474197425, 2.1301015593237693, 2.1274980703666695, 2.1249026051907767, 2.122315089425431, 2.1197354496692573, 2.117163613472849, 2.1145995093218355, 2.1120430666203176, 2.10949421567468, 2.1069528876777515, 2.104419014693312, 2.10189252964094, 2.099373366281185, 2.0968614592010626, 2.0943567437998594, 2.09185915627524, 2.0893686336096544, 2.0868851135570265, 2.08440853462973, 2.081938836085835, 2.07947595791662, 2.0770198408343474, 2.0745704262602875, 2.0721276563129964, 2.0696914737968273, 2.0672618221906833, 2.0648386456369976, 2.0624218889309334, 2.0600114975098096, 2.0576074174427297, 2.055209595420431, 2.052817978745321, 2.050432515321728, 2.048053153646332, 2.0456798427987897, 2.0433125324325436, 2.0409511727658103, 2.0385957145727436, 2.036246109174768, 2.033902308432084, 2.031564264735331, 2.0292319309974123, 2.026905260645479, 2.0245842076130627, 2.022268726332356, 2.0199587717266434, 2.0176542992028694, 2.0153552646443504, 2.013061624403616, 2.01077333529539, 2.0084903545896977, 2.0062126400050992, 2.003940149702049, 2.0016728422763745, 1.9994106767528783, 1.9971536125790494, 1.9949016096188934, 1.9926546281468704, 1.990412628841945, 1.9881755727817394, 1.9859434214367904, 1.9837161366649125, 1.981493680705655, 1.9792760161748595, 1.9770631060593133, 1.9748549137114932, 1.9726514028444062, 1.970452537526511, 1.9682582821767367, 1.966068601559581, 1.9638834607802929, 1.9617028252801412, 1.9595266608317592, 1.9573549335345717, 1.9551876098102958, 1.9530246563985219, 1.9508660403523628, 1.9487117290341833, 1.946561690111392, 1.94441589155231, 1.9422743016221047, 1.94013688887879, 1.938003622169294, 1.9358744706255901, 1.9337494036608907, 1.9316283909659036, 1.9295114025051465, 1.9273984085133256, 1.9252893794917676, 1.9231842862049107, 1.921083099676852, 1.9189857911879495, 1.9168923322714768, 1.9148026947103318, 1.9127168505337961, 1.910634772014348, 1.9085564316645194, 1.9064818022338081, 1.9044108567056335, 1.9023435682943421, 1.9002799104422556, 1.8982198568167696, 1.8961633813074903, 1.8941104580234205, 1.8920610612901838, 1.8900151656472948, 1.8879727458454671, 1.885933776843963, 1.8838982338079837, 1.8818660921060972, 1.8798373273077043, 1.8778119151805444, 1.8757898316882338, 1.873771052987845, 1.8717555554275194, 1.8697433155441114, 1.8677343100608752, 1.865728515885176, 1.8637259101062402, 1.8617264699929357, 1.8597301729915847, 1.857736996723808, 1.8557469189843983, 1.8537599177392263, 1.8517759711231756, 1.8497950574381044, 1.84781715515084, 1.8458422428911971, 1.8438702994500278, 1.8419013037772953, 1.839935234980177, 1.8379720723211914, 1.8360117952163526, 1.8340543832333491, 1.8320998160897484, 1.8301480736512257, 1.828199135929815, 1.8262529830821879, 1.82430959540795, 1.8223689533479657, 1.820431037482702, 1.8184958285305945, 1.8165633073464382, 1.8146334549197942, 1.8127062523734236, 1.8107816809617372, 1.8088597220692677, 1.8069403572091614, 1.8050235680216897, 1.8031093362727797, 1.8011976438525634, 1.7992884727739464, 1.7973818051711947, 1.795477623298538, 1.7935759095287946, 1.7916766463520089, 1.7897798163741092, 1.787885402315583, 1.7859933870101647, 1.7841037534035462, 1.782216484552097, 1.7803315636216037, 1.7784489738860259, 1.7765686987262643, 1.7746907216289465, 1.7728150261852258, 1.770941596089597, 1.769070415138723, 1.7672014672302794, 1.7653347363618106, 1.7634702066295997, 1.761607862227553, 1.7597476874460967, 1.7578896666710875, 1.756033784382735, 1.7541800251545385, 1.7523283736522342, 1.750478814632755, 1.7486313329432048, 1.7467859135198407, 1.7449425413870707, 1.7431012016564598, 1.7412618795257497, 1.7394245602778886, 1.7375892292800708, 1.7357558719827912, 1.733924473918905, 1.732095020702702, 1.7302674980289874, 1.7284418916721789, 1.7266181874854065, 1.724796371399628, 1.722976429422749, 1.7211583476387584, 1.7193421122068677, 1.717527709360663, 1.7157151254072642, 1.7139043467264947, 1.7120953597700592, 1.7102881510607295, 1.7084827071915405, 1.7066790148249933, 1.7048770606922647, 1.7030768315924325, 1.7012783143916976, 1.699481496022623, 1.6976863634833772, 1.6958929038369852, 1.6941011042105871, 1.6923109517947055, 1.6905224338425173, 1.6887355376691366, 1.6869502506509013, 1.6851665602246697, 1.6833844538871197, 1.6816039191940606, 1.679824943759747, 1.6780475152561989, 1.6762716214125346, 1.6744972500143007, 1.6727243889028167, 1.6709530259745202, 1.6691831491803213, 1.6674147465249614, 1.6656478060663793, 1.6638823159150806, 1.6621182642335168, 1.6603556392354655, 1.6585944291854193, 1.6568346223979802, 1.6550762072372565, 1.653319172116268, 1.6515635054963558, 1.6498091958865957, 1.6480562318432173, 1.6463046019690306, 1.6445542949128524, 1.6428052993689437, 1.6410576040764453, 1.6393111978188235, 1.6375660694233176, 1.6358222077603926, 1.634079601743196, 1.6323382403270195, 1.630598112508765, 1.6288592073264139, 1.6271215138585016, 1.6253850212235956, 1.623649718579779, 1.6219155951241333, 1.6201826400922332, 1.6184508427576367, 1.6167201924313848, 1.614990678461502, 1.6132622902325013, 1.6115350171648943, 1.6098088487147013, 1.6080837743729677, 1.6063597836652836, 1.6046368661513057, 1.6029150114242825, 1.601194209110583, 1.5994744488692303, 1.597755720391435, 1.5960380134001333, 1.59432131764953, 1.5926056229246408, 1.5908909190408398, 1.5891771958434098, 1.5874644432070946, 1.5857526510356537, 1.5840418092614221, 1.5823319078448688, 1.5806229367741618, 1.5789148860647324, 1.5772077457588454, 1.5755015059251671, 1.5737961566583414, 1.5720916880785625, 1.5703880903311547, 1.5686853535861498, 1.5669834680378727, 1.5652824239045218, 1.5635822114277593, 1.5618828208722955, 1.560184242525482, 1.5584864666969036, 1.5567894837179719, 1.5550932839415215, 1.5533978577414083, 1.5517031955121097, 1.550009287668324, 1.5483161246445771, 1.5466236968948235, 1.5449319948920552, 1.5432410091279094, 1.5415507301122766, 1.539861148372913, 1.5381722544550522, 1.5364840389210204, 1.5347964923498483, 1.5331096053368918, 1.5314233684934468, 1.5297377724463692, 1.528052807837695, 1.5263684653242606, 1.5246847355773283, 1.5230016092822063, 1.5213190771378748, 1.5196371298566118, 1.5179557581636194, 1.5162749527966506, 1.5145947045056383, 1.5129150040523238, 1.5112358422098877, 1.5095572097625796, 1.5078790975053498, 1.506201496243481, 1.5045243967922226, 1.5028477899764214, 1.5011716666301573, 1.4994960175963779, 1.4978208337265317, 1.4961461058802061, 1.49447182492476, 1.4927979817349621, 1.4911245671926268, 1.4894515721862507, 1.4877789876106498, 1.4861068043665968, 1.4844350133604587, 1.4827636055038336, 1.481092571713189, 1.4794219029095, 1.4777515900178857, 1.4760816239672478, 1.4744119956899084, 1.4727426961212473, 1.4710737161993401, 1.4694050468645943, 1.467736679059388, 1.466068603727705, 1.4644008118147733, 1.4627332942667, 1.4610660420301078, 1.4593990460517707, 1.4577322972782487, 1.4560657866555222, 1.4543995051286274, 1.4527334436412886, 1.4510675931355508, 1.449401944551414, 1.4477364888264632, 1.4460712168954994, 1.444406119690171, 1.4427411881386019, 1.4410764131650202, 1.439411785689387, 1.4377472966270226, 1.4360829368882309, 1.4344186973779265, 1.4327545689952568, 1.4310905426332254, 1.4294266091783139, 1.4277627595101008, 1.4260989845008825, 1.4244352750152902, 1.422771621909906, 1.4211080160328795, 1.4194444482235404, 1.4177809093120113, 1.416117390118819, 1.4144538814545031, 1.4127903741192243, 1.4111268589023702, 1.4094633265821606, 1.407799767925249, 1.4061361736863252, 1.4044725346077127, 1.4028088414189677, 1.401145084836473, 1.3994812555630327, 1.3978173442874633, 1.3961533416841827, 1.3944892384127971, 1.392825025117688, 1.391160692427592, 1.3894962309551846, 1.3878316312966572, 1.3861668840312908, 1.3845019797210338, 1.3828369089100696, 1.381171662124386, 1.379506229871341, 1.3778406026392267, 1.376174770896829, 1.374508725092985, 1.372842455656138, 1.371175952993891, 1.3695092074925526, 1.367842209516686, 1.3661749494086513, 1.3645074174881426, 1.3628396040517277, 1.3611714993723807, 1.3595030936990107, 1.3578343772559895, 1.356165340242674, 1.3544959728329269, 1.3528262651746308, 1.3511562073892018, 1.3494857895710977, 1.347815001787323, 1.346143834076929, 1.3444722764505104, 1.3428003188897, 1.341127951346655, 1.3394551637435432, 1.3377819459720222, 1.3361082878927155, 1.334434179334685, 1.3327596100948957, 1.3310845699376803, 1.3294090485941956, 1.327733035761875, 1.3260565211038784, 1.3243794942485336, 1.3227019447887742, 1.321023862281574, 1.3193452362473734, 1.3176660561695026, 1.3159863114935981, 1.314305991627015, 1.3126250859382318, 1.310943583756251, 1.309261474369995, 1.3075787470276923, 1.3058953909362612, 1.3042113952606866, 1.3025267491233894, 1.3008414416035912, 1.2991554617366705, 1.2974687985135147, 1.2957814408798645, 1.2940933777356496, 1.2924045979343215, 1.2907150902821747, 1.2890248435376654, 1.2873338464107187, 1.2856420875620305, 1.283949555602363, 1.2822562390918293, 1.2805621265391731, 1.2788672064010396, 1.2771714670812373, 1.2754748969299932, 1.273777484243198, 1.2720792172616442, 1.2703800841702553, 1.2686800730973053, 1.2669791721136294, 1.2652773692318273, 1.2635746524054539, 1.2618710095282046, 1.2601664284330876, 1.258460896891588, 1.256754402612822, 1.255046933242679, 1.2533384763629578, 1.251629019490487, 1.249918550076239, 1.2482070555044293, 1.2464945230916082, 1.24478094008574, 1.243066293665269, 1.241350570938177, 1.239633758941026, 1.237915844637991, 1.2361968149198779, 1.234476656603133, 1.232755356428835, 1.2310329010616763, 1.2293092770889336, 1.2275844710194186, 1.2258584692824221, 1.2241312582266382, 1.2224028241190794, 1.2206731531439725, 1.2189422314016438, 1.2172100449073857, 1.2154765795903124, 1.2137418212921938, 1.2120057557662811, 1.2102683686761089, 1.2085296455942867, 1.20678957200127, 1.2050481332841159, 1.2033053147352204, 1.2015611015510403, 1.1998154788307929, 1.1980684315751415, 1.1963199446848591, 1.194570002959476, 1.1928185910959046, 1.1910656936870465, 1.1893112952203808, 1.1875553800765264, 1.1857979325277903, 1.1840389367366888, 1.182278376754452, 1.1805162365195, 1.1787524998559027, 1.1769871504718117, 1.1752201719578723, 1.1734515477856091, 1.1716812613057872, 1.1699092957467512, 1.1681356342127351, 1.1663602596821485, 1.1645831550058365, 1.1628043029053112, 1.1610236859709568, 1.1592412866602069, 1.1574570872956924, 1.1556710700633601, 1.1538832170105626, 1.1520935100441174, 1.1503019309283344, 1.1485084612830123, 1.1467130825814034, 1.144915776148144, 1.143116523157152, 1.1413153046294915, 1.1395121014311995, 1.13770689427108, 1.1358996636984595, 1.1340903901009063, 1.1322790537019118, 1.1304656345585318, 1.1286501125589903, 1.1268324674202412, 1.1250126786854897, 1.1231907257216702, 1.121366587716882, 1.1195402436777826, 1.1177116724269331, 1.1158808526000983, 1.1140477626435026, 1.112212380811034, 1.1103746851614034, 1.108534653555249, 1.1066922636521934, 1.1048474929078478, 1.1030003185707606, 1.101150717679314, 1.0992986670585638, 1.09744414331702, 1.0955871228433731, 1.093727581803158, 1.0918654961353569, 1.0900008415489402, 1.0881335935193452, 1.0862637272848856, 1.084391217843098, 1.0825160399470184, 1.0806381681013877, 1.0787575765587887, 1.0768742393157065, 1.0749881301085156, 1.0730992224093898, 1.071207489422135, 1.0693129040779394, 1.0674154390310415, 1.065515066654317, 1.0636117590347733, 1.0617054879689645, 1.059796224958305, 1.0578839412043002, 1.0559686076036756, 1.0540501947434118, 1.0521286728956782, 1.050204012012666, 1.048276181721315, 1.0463451513179334, 1.0444108897627071, 1.0424733656740983, 1.0405325473231255, 1.038588402627526, 1.0366408991457983, 1.0346900040711167, 1.0327356842251199, 1.0307779060515685, 1.0288166356098667, 1.0268518385684458, 1.0248834801980071, 1.0229115253646173, 1.020935938522657, 1.0189566837076123, 1.0169737245287118, 1.0149870241614016, 1.0129965453396523, 1.0110022503480978, 1.0090041010139956, 1.0070020586990114, 1.0049960842908148, 1.0029861381944878, 1.0009721803237355, 0.9989541700918976, 0.9969320664027531, 0.9949058276411132, 0.9928754116631944, 0.990840775786769, 0.9888018767810836, 0.9867586708565405, 0.9847111136541348, 0.9826591602346406, 0.9806027650675372, 0.9785418820196692, 0.9764764643436342, 0.9744064646658855, 0.9723318349745467, 0.9702525266069251, 0.9681684902367172, 0.9660796758608966, 0.9639860327862757, 0.9618875096157266, 0.9597840542340587, 0.9576756137935355, 0.9555621346990198, 0.9534435625927432, 0.9513198423386761, 0.9491909180064974, 0.9470567328551431, 0.9449172293159231, 0.9427723489751954, 0.9406220325565727, 0.9384662199026668, 0.9363048499563278, 0.9341378607413893, 0.9319651893428821, 0.9297867718867101, 0.92760254351877, 0.9254124383834874, 0.9232163896017632, 0.9210143292482943, 0.9188061883282644, 0.9165918967533672, 0.9143713833171503, 0.9121445756696511, 0.9099114002912995, 0.9076717824660625, 0.9054256462538072, 0.9031729144618477, 0.900913508615649, 0.8986473489286642, 0.8963743542712606, 0.8940944421387115, 0.8918075286182162, 0.8895135283549119, 0.8872123545168374, 0.8849039187588147, 0.8825881311852017, 0.8802649003114771, 0.8779341330246115, 0.8755957345421752, 0.8732496083701373, 0.8708956562593048, 0.8685337781603415, 0.8661638721773214, 0.8637858345197472, 0.8613995594529793, 0.8590049392470047, 0.8566018641234864, 0.8541902222010126, 0.8517698994384777, 0.8493407795765174, 0.8469027440769091, 0.8444556720598587, 0.8419994402390809, 0.8395339228545774, 0.8370589916030132, 0.834574515565585, 0.8320803611332764, 0.829576391929375, 0.8270624687291376, 0.8245384493764683, 0.8220041886974796, 0.8194595384107874, 0.8169043470343936, 0.8143384597889932, 0.8117617184975456, 0.8091739614809222, 0.8065750234494521, 0.8039647353901622, 0.8013429244495092, 0.7987094138113722, 0.7960640225700846, 0.7934065655982439, 0.7907368534090513, 0.7880546920128898, 0.7853598827678538, 0.7826522222239187, 0.7799315019604083, 0.7771975084164228, 0.7744500227138382, 0.7716888204724892, 0.7689136716171058, 0.7661243401755566, 0.7633205840679176, 0.7605021548858519, 0.7576687976617625, 0.7548202506271265, 0.751956244959398, 0.7490765045168082, 0.7461807455603616, 0.7432686764622631, 0.7403399973999644, 0.737394400034963, 0.7344315671754161, 0.731451172421574, 0.7284528797929528, 0.7254363433360965, 0.7224012067116881, 0.719347102759667, 0.7162736530409272, 0.7131804673540315, 0.7100671432252832, 0.7069332653703363, 0.7037784051254085, 0.7006021198459713, 0.6974039522706416, 0.6941834298477971, 0.6909400640222265, 0.6876733494789016, 0.6843827633406971, 0.681067764316612, 0.6777277917967296, 0.6743622648898262, 0.670970581399146, 0.6675521167314518, 0.6641062227340105, 0.6606322264536333, 0.6571294288113493, 0.6535971031856379, 0.6500344938964473, 0.6464408145814353, 0.6428152464549808, 0.6391569364395344, 0.6354649951577551, 0.631738494772641, 0.6279764666614445, 0.6241778989075853, 0.6203417335929751, 0.6164668638711316, 0.6125521307991547, 0.6085963199040078, 0.6045981574555531, 0.6005563064153661, 0.5964693620264292, 0.5923358470042994, 0.5881542062851722, 0.5839228012802445, 0.5796399035788893, 0.5753036880350744, 0.5709122251620995, 0.5664634727498004, 0.5619552666055063, 0.5573853103050129, 0.5527511638220037, 0.5480502308833248, 0.5432797448724709, 0.5384367530737676, 0.5335180990139546, 0.5285204026147626, 0.5234400378179781, 0.5182731072811837, 0.5130154136650287, 0.5076624269379227, 0.5022092470068217, 0.4966505608370675, 0.4909805930421632, 0.4851930486951036, 0.47928104682230727, 0.47323704266994115, 0.4670527363543892, 0.4607189648875037, 0.45422557375293765, 0.4475612631312449, 0.4407134024274338, 0.43366780479877853, 0.42640845069785366, 0.418917145714778, 0.4111730927357958, 0.40315235087684514, 0.3948271426054063, 0.38616495399591605, 0.37712734795644304, 0.36766837101373673, 0.35773237112355893, 0.3472509391460236, 0.33613850596763, 0.32428580221160136, 0.3115497722213108, 0.29773729637344015, 0.28257739388596054, 0.26567019711540946, 0.24638383856125567, 0.22361591438436307, 0.19511408233366942, 0.15464348699476108, 0}

var optimizedNormalZigguratStripTops [1024]float64 = [1024]float64{0.00022849294245965983, 0.00047662746211361867, 0.0007341358289080094, 0.000998377645136875, 0.0012680040606002539, 0.0015421781995253701, 0.00182032380303587, 0.0021020169559715736, 0.0023869311553314137, 0.002674806264999718, 0.0029654295599057722, 0.0032586234559023376, 0.003554237195203617, 0.0038521410002663554, 0.00415222183620127, 0.004454380259635687, 0.004758528023926438, 0.005064586224710029, 0.00537248384020351, 0.0056821565655915994, 0.005993545870317198, 0.006306598226929626, 0.006621264473796554, 0.006937499283563012, 0.007255260716084825, 0.007574509839531414, 0.007895210407012434, 0.008217328578814569, 0.008540832682398865, 0.008865693003886984, 0.009191881605982007, 0.009519372168219692, 0.009848139846192022, 0.01017816114697809, 0.0105094138184898, 0.01084187675082102, 0.011175529887997993, 0.011510354148780173, 0.011846331355367279, 0.012183444169039449, 0.012521676031897602, 0.012861011113990604, 0.01320143426521281, 0.013542930971440536, 0.013885487314444687, 0.014229089935177276, 0.014573726000080089, 0.014919383170107058, 0.015266049572189784, 0.015613713772906315, 0.015962364754143216, 0.016311991890562438, 0.0166625849287077, 0.017014133967601493, 0.017366629440701057, 0.01772006209909447, 0.018074422995831254, 0.018429703471292146, 0.01878589513951188, 0.019142989875378304, 0.01950097980263711, 0.019859857282640326, 0.020219614903778996, 0.020580245471550955, 0.020941741999213365, 0.021304097698979, 0.021667305973716206, 0.022031360409116196, 0.022396254766295445, 0.02276198297480286, 0.023128539126003687, 0.023495917466815522, 0.023864112393772393, 0.02423311844739561, 0.024602930306851935, 0.024973542784880325, 0.025344950822970527, 0.02571714948677779, 0.026090133961759625, 0.02646389954902064, 0.02683844166135347, 0.027213755819463815, 0.027589837648369562, 0.027966682873963068, 0.028344287319727844, 0.02872264690360142, 0.02910175763497505, 0.029481615611823987, 0.029862217017960536, 0.030243558120403406, 0.03062563526685758, 0.031008444883298264, 0.031391983471654165, 0.03177624760758442, 0.03216123393834501, 0.03254693918073962, 0.032933360119150955, 0.03332049360364884, 0.0337083365481711, 0.03409688592877332, 0.03448613878194508, 0.03487609220298893, 0.035266743344459096, 0.03565808941465767, 0.03605012767618508, 0.036442855444542906, 0.036836270086785895, 0.03723036902022227, 0.03762514971115871, 0.03802060967368925, 0.038416746468525366, 0.03881355770186631, 0.03921104102430688, 0.039609194129782255, 0.04000801475454733, 0.04040750067618986, 0.04080764971267555, 0.04120845972142399, 0.04160992859841411, 0.042012054277318314, 0.04241483472866329, 0.042818267959017636, 0.04322235201020424, 0.04362708495853719, 0.0440324649140814, 0.04443849001993523, 0.044845158451534285, 0.04525246841597599, 0.045660418151364096, 0.04606900592617261, 0.04647823003862799, 0.04688808881610927, 0.047298580614565364, 0.04770970381794897, 0.04812145683766675, 0.048533838112044266, 0.04894684610580637, 0.04936047930957204, 0.04977473623936243, 0.05018961543612327, 0.050605115465259226, 0.051021234916181775, 0.05143797240186808, 0.05185532655843271, 0.052273296044709726, 0.052691879541846114, 0.05311107575290608, 0.05353088340248482, 0.053951301236332835, 0.05437232802098983, 0.05479396254342749, 0.055216203610701634, 0.055639050049612684, 0.05606250070637542, 0.056486554446295606, 0.05691121015345595, 0.057336466730408736, 0.05776232309787623, 0.05818877819445872, 0.05861583097634899, 0.05904348041705389, 0.059471725507122604, 0.0599005652538809, 0.060329998681172614, 0.06076002482910559, 0.06119064275380529, 0.06162185152717277, 0.062053650236648834, 0.06248603798498312, 0.06291901389000953, 0.06335257708442506, 0.06378672671557514, 0.06422146194524282, 0.06465678194944305, 0.06509268591822166, 0.06552917305545834, 0.06596624257867406, 0.0664038937188431, 0.06684212572020869, 0.06728093784010283, 0.06772032934877012, 0.06816029952919497, 0.06860084767693296, 0.06904197309994525, 0.06948367511843757, 0.0699259530647006, 0.07036880628295628, 0.07081223412920483, 0.071256235971077, 0.07170081118768766, 0.07214595916949414, 0.07259167931815554, 0.07303797104639659, 0.07348483377787357, 0.07393226694704275, 0.07438026999903202, 0.07482884238951439, 0.0752779835845849, 0.07572769306063934, 0.07617797030425554, 0.07662881481207716, 0.07708022609069945, 0.07753220365655797, 0.07798474703581815, 0.07843785576426891, 0.07889152938721626, 0.07934576745938093, 0.07980056954479621, 0.08025593521670943, 0.08071186405748379, 0.08116835565850315, 0.0816254096200784, 0.0820830255513551, 0.08254120307022376, 0.08299994180323084, 0.08345924138549253, 0.08391910146060873, 0.08437952168058037, 0.08484050170572682, 0.08530204120460537, 0.0857641398539328, 0.08622679733850729, 0.08669001335113254, 0.08715378759254322, 0.08761811977133169, 0.08808300960387591, 0.08854845681426915, 0.08901446113425018, 0.08948102230313591, 0.08994814006775403, 0.09041581418237789, 0.09088404440866192, 0.09135283051557846, 0.0918221722793558, 0.09229206948341724, 0.09276252191832145, 0.09323352938170347, 0.09370509167821746, 0.09417720861947983, 0.09464988002401356, 0.09512310571719418, 0.09559688553119537, 0.09607121930493752, 0.09654610688403453, 0.09702154812074484, 0.09749754287391998, 0.09797409100895688, 0.09845119239774917, 0.09892884691864044, 0.09940705445637754, 0.09988581490206533, 0.1003651281531222, 0.10084499411323575, 0.10132541269232029, 0.1018063838064743, 0.10228790737793876, 0.10276998333505674, 0.10325261161223319, 0.10373579214989567, 0.10421952489445595, 0.10470380979827172, 0.1051886468196101, 0.10567403592261039, 0.1061599770772487, 0.10664647025930267, 0.10713351545031695, 0.10762111263756946, 0.10810926181403764, 0.10859796297836627, 0.10908721613483538, 0.10957702129332868, 0.11006737846930258, 0.11055828768375608, 0.11104974896320129, 0.11154176233963366, 0.11203432785050392, 0.1125274455386898, 0.11302111545246843, 0.11351533764548974, 0.11401011217674921, 0.1145054391105629, 0.11500131851654112, 0.1154977504695638, 0.11599473504975624, 0.11649227234246474, 0.11699036243823327, 0.11748900543278028, 0.11798820142697636, 0.1184879505268218, 0.11898825284342536, 0.1194891084929822, 0.11999051759675412, 0.12049248028104835, 0.12099499667719797, 0.12149806692154248, 0.1220016911554084, 0.12250586952509065, 0.12301060218183447, 0.12351588928181707, 0.12402173098613081, 0.12452812746076528, 0.125035078876591, 0.1255425854093432, 0.1260506472396055, 0.12655926455279434, 0.12706843753914404, 0.12757816639369154, 0.12808845131626215, 0.1285992925114549, 0.12911069018862942, 0.1296226445618919, 0.13013515585008215, 0.13064822427676062, 0.13116185007019626, 0.13167603346335396, 0.13219077469388305, 0.13270607400410553, 0.13322193164100524, 0.1337383478562165, 0.134255322906014, 0.13477285705130232, 0.13529095055760598, 0.13580960369505993, 0.13632881673840014, 0.13684858996695434, 0.1373689236646337, 0.13788981811992415, 0.13841127362587785, 0.13893329048010614, 0.13945586898477094, 0.13997900944657826, 0.14050271217677066, 0.14102697749112067, 0.14155180570992418, 0.14207719715799424, 0.1426031521646552, 0.14312967106373706, 0.14365675419356963, 0.14418440189697782, 0.14471261452127646, 0.14524139241826586, 0.1457707359442273, 0.14630064545991855, 0.14683112133057064, 0.14736216392588364, 0.14789377362002373, 0.14842595079161955, 0.1489586958237597, 0.1494920091039899, 0.15002589102431058, 0.1505603419811747, 0.15109536237548582, 0.15163095261259651, 0.15216711310230652, 0.152703844258862, 0.15324114650095408, 0.15377902025171855, 0.15431746593873477, 0.15485648399402582, 0.15539607485405812, 0.15593623895974176, 0.15647697675643069, 0.1570182886939234, 0.15756017522646382, 0.1581026368127422, 0.15864567391589615, 0.1591892870035129, 0.15973347654762995, 0.16027824302473778, 0.1608235869157816, 0.16136950870616362, 0.16191600888574614, 0.16246308794885347, 0.1630107463942758, 0.1635589847252716, 0.1641078034495718, 0.16465720307938272, 0.16520718413139027, 0.16575774712676417, 0.16630889259116158, 0.16686062105473223, 0.16741293305212285, 0.1679658291224817, 0.1685193098094643, 0.16907337566123817, 0.1696280272304889, 0.17018326507442513, 0.17073908975478524, 0.17129550183784276, 0.17185250189441323, 0.1724100904998607, 0.17296826823410388, 0.17352703568162406, 0.17408639343147136, 0.17464634207727264, 0.1752068822172388, 0.17576801445417267, 0.1763297393954771, 0.17689205765316265, 0.17745496984385656, 0.17801847658881084, 0.17858257851391174, 0.17914727624968785, 0.17971257043132005, 0.18027846169865028, 0.180844950696192, 0.18141203807313905, 0.18197972448337624, 0.1825480105854896, 0.18311689704277642, 0.1836863845232564, 0.18425647369968193, 0.18482716524954967, 0.1853984598551115, 0.18597035820338587, 0.18654286098617012, 0.18711596890005128, 0.18768968264641916, 0.18826400293147844, 0.1888389304662604, 0.18941446596663683, 0.18999061015333196, 0.190567363751936, 0.19114472749291878, 0.19172270211164277, 0.19230128834837723, 0.19288048694831178, 0.19346029866157124, 0.19404072424322938, 0.19462176445332388, 0.19520342005687147, 0.19578569182388206, 0.19636858052937514, 0.19695208695339445, 0.19753621188102416, 0.19812095610240452, 0.19870632041274813, 0.19929230561235625, 0.19987891250663573, 0.20046614190611525, 0.2010539946264627, 0.20164247148850278, 0.20223157331823363, 0.20282130094684536, 0.20341165521073773, 0.20400263695153822, 0.20459424701612036, 0.20518648625662295, 0.20577935553046803, 0.20637285570038102, 0.20696698763440888, 0.20756175220594095, 0.20815715029372786, 0.20875318278190183, 0.2093498505599972, 0.20994715452297052, 0.21054509557122192, 0.2111436746106155, 0.21174289255250114, 0.21234275031373576, 0.21294324881670498, 0.21354438898934522, 0.2141461717651664, 0.21474859808327368, 0.2153516688883908, 0.21595538513088278, 0.21655974776677955, 0.2171647577577994, 0.21777041607137243, 0.2183767236806649, 0.21898368156460407, 0.2195912907079016, 0.22019955210107953, 0.22080846674049487, 0.2214180356283653, 0.2220282597727945, 0.22263914018779843, 0.22325067789333156, 0.22386287391531304, 0.22447572928565382, 0.22508924504228386, 0.22570342222917916, 0.22631826189638932, 0.22693376510006627, 0.22754993290249131, 0.2281667663721049, 0.2287842665835344, 0.22940243461762416, 0.230021271561464, 0.23064077850841977, 0.2312609565581629, 0.23188180681670081, 0.23250333039640775, 0.23312552841605583, 0.23374840200084576, 0.23437195228243923, 0.23499618039899, 0.2356210874951772, 0.23624667472223684, 0.2368729432379952, 0.23749989420690232, 0.2381275288000651, 0.2387558481952815, 0.23938485357707456, 0.24001454613672743, 0.24064492707231758, 0.24127599758875293, 0.2419077588978068, 0.2425402122181543, 0.24317335877540852, 0.2438071998021574, 0.24444173653800066, 0.2450769702295871, 0.24571290213065303, 0.24634953350205951, 0.24698686561183184, 0.24762489973519797, 0.24826363715462807, 0.2489030791598743, 0.2495432270480105, 0.2501840821234732, 0.25082564569810245, 0.25146791909118293, 0.2521109036294858, 0.25275460064731076, 0.25339901148652877, 0.25404413749662497, 0.25468998003474197, 0.25533654046572357, 0.25598382016215926, 0.25663182050442895, 0.2572805428807478, 0.257929988687212, 0.25858015932784484, 0.2592310562146429, 0.2598826807676233, 0.26053503441487064, 0.2611881185925856, 0.26184193474513257, 0.26249648432508893, 0.2631517687932937, 0.2638077896188983, 0.2644645482794158, 0.2651220462607723, 0.265780285057358, 0.2664392661720789, 0.2670989911164092, 0.267759461410444, 0.2684206785829527, 0.26908264417143274, 0.2697453597221641, 0.27040882679026396, 0.27107304693974243, 0.27173802174355843, 0.2724037527836762, 0.27307024165112265, 0.27373748994604474, 0.27440549927776786, 0.2750742712648549, 0.27574380753516514, 0.27641410972591507, 0.2770851794837382, 0.27775701846474654, 0.27842962833459306, 0.2791030107685332, 0.27977716745148823, 0.2804521000781097, 0.2811278103528428, 0.2818042999899917, 0.28248157071378543, 0.2831596242584443, 0.283838462368246, 0.2845180867975947, 0.2851984993110878, 0.2858797016835865, 0.2865616957002842, 0.287244483156778, 0.2879280658591391, 0.28861244562398536, 0.2892976242785532, 0.2899836036607717, 0.2906703856193361, 0.2913579720137827, 0.2920463647145655, 0.29273556560313096, 0.2934255765719965, 0.294116399524828, 0.2948080363765187, 0.29550048905326864, 0.2961937594926654, 0.29688784964376497, 0.29758276146717433, 0.2982784969351338, 0.2989750580316017, 0.29967244675233823, 0.30037066510499155, 0.30106971510918384, 0.3017695987965995, 0.30247031821107234, 0.3031718754086758, 0.3038742724578124, 0.30457751143930517, 0.30528159444649017, 0.3059865235853083, 0.3066923009744008, 0.3073989287452034, 0.3081064090420427, 0.30881474402223297, 0.3095239358561744, 0.3102339867274527, 0.3109448988329388, 0.31165667438288996, 0.31236931560105297, 0.31308282472476695, 0.313797204005068, 0.31451245570679565, 0.31522858210869914, 0.3159455855035452, 0.31666346819822805, 0.3173822325138796, 0.3181018807859805, 0.318822415364474, 0.31954383861387897, 0.3202661529134062, 0.3209893606570747, 0.3217134642538289, 0.32243846612765914, 0.3231643687177216, 0.3238911744784596, 0.32461888587972804, 0.325347505406917, 0.32607703556107825, 0.32680747885905276, 0.327538837833599, 0.3282711150335239, 0.3290043130238144, 0.3297384343857705, 0.3304734817171405, 0.33120945763225684, 0.331946364762174, 0.3326842057548087, 0.33342298327507985, 0.3341627000050521, 0.33490335864407955, 0.3356449619089522, 0.33638751253404314, 0.33713101327145817, 0.3378754668911872, 0.33862087618125625, 0.3393672439478829, 0.34011457301563247, 0.3408628662275763, 0.3416121264454518, 0.3423623565498245, 0.3431135594402522, 0.3438657380354508, 0.34461889527346157, 0.34537303411182213, 0.3461281575277375, 0.34688426851825377, 0.3476413701004352, 0.34839946531154137, 0.3491585572092079, 0.3499186488716287, 0.3506797433977411, 0.35144184390741195, 0.35220495354162773, 0.35296907546268513, 0.35373421285438555, 0.3545003689222312, 0.3552675468936236, 0.3560357500180646, 0.35680498156735996, 0.3575752448358259, 0.358346543140497, 0.35911887982133806, 0.35989225824145765, 0.3606666817873249, 0.36144215386898887, 0.36221867792029994, 0.362996257399136, 0.3637748957876289, 0.3645545965923956, 0.3653353633447716, 0.3661171996010481, 0.3669001089427105, 0.3676840949766819, 0.36846916133556845, 0.3692553116779088, 0.3700425496884255, 0.3708308790782812, 0.3716203035853375, 0.372410826974416, 0.3732024530375657, 0.3739951855943307, 0.37478902849202306, 0.37558398560600004, 0.3763800608399429, 0.3771772581261414, 0.3779755814257804, 0.3787750347292323, 0.379575622056351, 0.3803773474567724, 0.38118021501021637, 0.3819842288267952, 0.38278939304732434, 0.3835957118436386, 0.384403189418912, 0.3852118300079825, 0.38602163787768073, 0.38683261732716384, 0.3876447726882529, 0.38845810832577654, 0.38927262863791773, 0.3900883380565674, 0.3909052410476804, 0.39172334211163856, 0.39254264578361886, 0.3933631566339647, 0.3941848792685656, 0.3950078183292392, 0.3958319784941213, 0.3966573644780587, 0.39748398103301164, 0.3983118329484577, 0.39914092505180476, 0.3999712622088081, 0.4008028493239947, 0.4016356913410935, 0.40246979324347104, 0.4033051600545748, 0.40414179683838275, 0.40497970869985866, 0.40581890078541544, 0.4066593782833851, 0.4075011464244947, 0.4083442104823507, 0.4091885757739302, 0.4100342476600797, 0.4108812315460207, 0.4117295328818643, 0.41257915716313276, 0.413430109931289, 0.41428239677427464, 0.41513602332705696, 0.4159909952721825, 0.4168473183403411, 0.41770499831093805, 0.4185640410126749, 0.41942445232413994, 0.4202862381744076, 0.4211494045436481, 0.42201395746374537, 0.42287990301892614, 0.4237472473463987, 0.42461599663700184, 0.42548615713586463, 0.42635773514307546, 0.4272307370143643, 0.42810516916179453, 0.42898103805446575, 0.42985835021923013, 0.4307371122414177, 0.43161733076557657, 0.4324990124962235, 0.4333821641986079, 0.434266792699488, 0.4351529048879206, 0.4360405077160643, 0.43692960819999577, 0.43782021342054034, 0.4387123305241165, 0.4396059667235951, 0.44050112929917346, 0.44139782559926377, 0.44229606304139885, 0.443195849113151, 0.44409719137306924, 0.44500009745163216, 0.4459045750522167, 0.4468106319520859, 0.44771827600339315, 0.4486275151342041, 0.4495383573495375, 0.4504508107324243, 0.45136488344498754, 0.4522805837295381, 0.45319791990969593, 0.4541169003915253, 0.45503753366469785, 0.45595982830367093, 0.4568837929688921, 0.45780943640802385, 0.4587367674571922, 0.4596657950422585, 0.4605965281801147, 0.4615289759800043, 0.46246314764486746, 0.46339905247271257, 0.4643366998580133, 0.46527609929313385, 0.4662172603697803, 0.4671601927804816, 0.46810490632009905, 0.4690514108873648, 0.4699997164864518, 0.4709498332285741, 0.47190177133361916, 0.4728555411318138, 0.4738111530654211, 0.47476861769047507, 0.47572794567854815, 0.4766891478185545, 0.4776522350185925, 0.47861721830782217, 0.47958410883838465, 0.4805529178873589, 0.48152365685876053, 0.48249633728558217, 0.48347097083187734, 0.4844475692948884, 0.4854261446072187, 0.48640670883905335, 0.48738927420042527, 0.48837385304353254, 0.48936045786510424, 0.49034910130881953, 0.4913397961677782, 0.4923325553870271, 0.49332739206614157, 0.49432431946186584, 0.49532335099081015, 0.4963245002322114, 0.4973277809307541, 0.49833320699945644, 0.49934079252262287, 0.5003505517588636, 0.5013624991441836, 0.5023766492951462, 0.5033930170121063, 0.5044116172825228, 0.5054324652843488, 0.506455576389501, 0.5074809661674131, 0.5085086503886749, 0.5095386450287578, 0.5105709662718322, 0.5116056305146776, 0.5126426543706892, 0.5136820546739824, 0.514723848483601, 0.5157680530878282, 0.5168146860086092, 0.5178637650060832, 0.5189153080832302, 0.51996933349064, 0.5210258597313998, 0.5220849055661122, 0.5231464900180407, 0.5242106323783926, 0.5252773522117393, 0.5263466693615817, 0.5274186039560638, 0.5284931764138395, 0.5295704074500986, 0.5306503180827556, 0.5317329296388099, 0.5328182637608785, 0.5339063424139124, 0.5349971878920995, 0.5360908228259603, 0.537187270189646, 0.5382865533084429, 0.5393886958664929, 0.5404937219147358, 0.5416016558790827, 0.5427125225688275, 0.5438263471853073, 0.5449431553308187, 0.5460629730177993, 0.5471858266782865, 0.5483117431736619, 0.5494407498046924, 0.550572874321879, 0.551708144936127, 0.5528465903297465, 0.553988239667799, 0.5551331226098023, 0.5562812693218064, 0.557432710488859, 0.5585874773278711, 0.5597456016009029, 0.5609071156288841, 0.5620720523057878, 0.5632404451132774, 0.5644123281358425, 0.5655877360764486, 0.5667667042727196, 0.5679492687136755, 0.5691354660570506, 0.570325333647215, 0.571518909533728, 0.5727162324905493, 0.5739173420359368, 0.575122278453063, 0.5763310828113811, 0.5775437969887748, 0.5787604636945274, 0.5799811264931487, 0.5812058298290985, 0.5824346190524488, 0.5836675404455296, 0.5849046412506042, 0.5861459696986255, 0.5873915750391211, 0.58864150757127, 0.5898958186762197, 0.5911545608507169, 0.592417787742108, 0.593685554184784, 0.5949579162381445, 0.5962349312261558, 0.5975166577785901, 0.5988031558740314, 0.600094486884747, 0.6013907136235173, 0.6026919003925408, 0.6039981130345194, 0.6053094189860488, 0.6066258873334449, 0.6079475888711422, 0.6092745961628122, 0.6106069836053599, 0.6119448274959671, 0.6132882061023643, 0.6146371997365203, 0.6159918908319642, 0.6173523640249554, 0.6187187062397445, 0.6200910067781805, 0.6214693574139417, 0.6228538524916853, 0.6242445890314381, 0.625641666838573, 0.6270451886197431, 0.6284552601051778, 0.6298719901777735, 0.6312954910094533, 0.6327258782053037, 0.6341632709560441, 0.6356077921994265, 0.6370595687912238, 0.6385187316865143, 0.6399854161320375, 0.6414597618704659, 0.6429419133575149, 0.6444320199929, 0.6459302363662445, 0.6474367225191457, 0.6489516442247328, 0.6504751732861696, 0.6520074878557142, 0.6535487727761037, 0.6550992199462206, 0.656659028713203, 0.6582284062933947, 0.6598075682247889, 0.6613967388539231, 0.6629961518605108, 0.6646060508234753, 0.6662266898324894, 0.6678583341496047, 0.6695012609261273, 0.6711557599805246, 0.672822134643898, 0.6745007026803871, 0.6761917972908639, 0.6778957682093883, 0.6796129829032159, 0.6813438278886703, 0.683088710176967, 0.6848480588661638, 0.6866223268978575, 0.6884119930001349, 0.6902175638417076, 0.6920395764262214, 0.6938786007605875, 0.6957352428370036, 0.6976101479753404, 0.699504004581058, 0.701417548384152, 0.7033515672372515, 0.705306906566555, 0.7072844755885288, 0.7092852544292835, 0.7113103023136286, 0.7133607670288319, 0.715437895916535, 0.717543048708462, 0.7196777126021334, 0.7218435200781954, 0.7240422701002712, 0.7262759535244205, 0.7285467837970958, 0.7308572343656383, 0.7332100847051767, 0.735608477543492, 0.7380559908392148, 0.7405567294951397, 0.743115443922815, 0.7457376858455851, 0.748430016877298, 0.7512002937751907, 0.7540580683281268, 0.757015164483344, 0.7600865406330924, 0.763291633290986, 0.7666565630790266, 0.7702180060530777, 0.7740306160172901, 0.7781831344128992, 0.7828406583203265, 0.788400825474071, 0.7978845608028653}

const optimizedNormalTailPrevSplit = 4.273928505132755

func OptimizedUnitNormalRand(src rand.Source) float64 {
	r := src.Uint64()
	index := r & (ZIGGURAT_N - 1)
	isNeg := (r & ZIGGURAT_N) == 0
	x := float64(r>>11) / (1 << 53)
	c := 0
	for {
		c++
		prevSplit := optimizedNormalTailPrevSplit
		if index > 0 {
			prevSplit = optimizedNormalZigguratStripSplits[index-1]
		}
		x *= prevSplit
		if x < optimizedNormalZigguratStripSplits[index] {
			if isNeg {
				return -x
			}
			return x
		}
		stripTop := optimizedNormalZigguratStripTops[index]
		if index == 0 {
			if isNeg {
				return -math.Sqrt2 * math.Erfinv(2*(1-(prevSplit-x)*stripTop)-1)
			}
			return math.Sqrt2 * math.Erfinv(2*(1-(prevSplit-x)*stripTop)-1)
		}
		stripBottom := 0.0
		if index > 0 {
			stripBottom = optimizedNormalZigguratStripTops[index-1]
		}
		if rand.New(src).Float64() < (math.Exp(-x*x/2)*math.Sqrt2/math.SqrtPi-stripBottom)/(stripTop-stripBottom) {
			if isNeg {
				return -x
			}
			return x
		}
		x = rand.New(src).Float64()
	}
}
